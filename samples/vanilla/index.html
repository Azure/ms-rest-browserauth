<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ms-rest-browserauth sample</title>
    <button id="login" onclick="onLoginClick()">Login</button>
    <div id="results"></div>
    <script src="node_modules/ms-rest-js/dist/msRest.browser.js"></script>
    <script src="node_modules/ms-rest-browserauth/dist/msAuth.js"></script>
    <script>
      const authManager = new msAuth.AuthManager({
        clientId: "<client id for your Azure AD app>",
        tenant: "<optional tenant for your organization>"
      });

      function onLoginClick() {
        authManager.login();
      }

      document.addEventListener("readystatechange", () => {
        authManager.finalizeLogin().then(res => {
          const results = document.getElementById('results');
          if (!res.isLoggedIn) {
            results.textContent = "Not logged in";
          } else {
            // These credentials can be provided to any azure-sdk-for-js client class.
            const creds = res.creds;

            results.textContent = "Subscriptions: " + JSON.stringify(res.availableSubscriptions);
          }
        });
      });
    </script>
  </head>
  <body>
  </body>
</html>